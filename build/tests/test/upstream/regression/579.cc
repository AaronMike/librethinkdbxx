// auto-generated by yaml_to_cxx.py from test/upstream/regression/579.yaml
#include "testlib.h"
void test_upstream_regression_579() {
    enter_section("test_upstream_regression_579: reject non-deterministic secondary indexes (#579)");
    temp_table tbl_table;
    R::Query tbl = tbl_table.table();
    tbl.insert(R::object("name", "Jim Brown")).run(*conn);
    TEST_EQ(tbl.index_create("579", [=](R::Var rec){ return R::js("1"); }).run(*conn), (err("RqlRuntimeError", "Could not prove function deterministic.  Index functions must be deterministic.", R::Array{})));
    TEST_EQ(tbl.index_create("579", [=](R::Var rec){ return tbl.get(0); }).run(*conn), (err("RqlRuntimeError", "Could not prove function deterministic.  Index functions must be deterministic.", R::Array{})));
    exit_section();
}
