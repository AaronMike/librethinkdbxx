// auto-generated by yaml_to_cxx.py from test/upstream/regression/578.yaml
#include "testlib.h"
void test_upstream_regression_578() {
    enter_section("test_upstream_regression_578: Catch obvious sindex creation/dropping errors (#578)");
    temp_table tbl_table;
    R::Query tbl = tbl_table.table();
    TEST_EQ(tbl.index_create("578", [=](R::Var rec){ return R::expr(1); }).run(*conn), (R::Object{{"created",1}}));
    TEST_EQ(tbl.index_wait("578").pluck("index", "ready").run(*conn), (R::Array{R::Object{{"ready",true}, {"index","578"}}}));
    TEST_EQ(tbl.index_create("578", [=](R::Var rec){ return R::expr(1); }).run(*conn), (err_regex("RqlRuntimeError", "Index `578` already exists on table `[a-zA-Z0-9_]+.[a-zA-Z0-9_]+`[.]", R::Array{})));
    TEST_EQ(tbl.index_drop("578").run(*conn), (R::Object{{"dropped",1}}));
    TEST_EQ(tbl.index_drop("578").run(*conn), (err_regex("RqlRuntimeError", "Index `578` does not exist on table `[a-zA-Z0-9_]+.[a-zA-Z0-9_]+`[.]", R::Array{})));
    exit_section();
}
