// auto-generated by yaml_to_cxx.py from test/upstream/regression/453.yaml
#include "testlib.h"
void test_upstream_regression_453() {
    enter_section("test_upstream_regression_453: Sanity Check Fails, with r.table() expression inside a map (#453)");
    temp_table tbl_table;
    R::Query tbl = tbl_table.table();
    TEST_EQ(maybe_run(tbl.insert(R::array(R::object("a", 1), R::object("a", 2))), *conn), (partial(R::Object{{"inserted", 2}})));
    TEST_EQ(maybe_run(tbl.map([=](R::Var x){ return tbl; }), *conn), (err("ReqlQueryLogicError", "Expected type DATUM but found TABLE:", R::Array{0})));
    TEST_EQ(maybe_run(tbl.map([=](R::Var x){ return tbl.coerce_to("array"); }).count(), *conn), (2));
    exit_section();
}
