// auto-generated by yaml_to_cxx.py from test/upstream/range.yaml
#include "testlib.h"
void test_upstream_range() {
    enter_section("test_upstream_range: Tests RQL range generation");
    TEST_EQ(R::range().type_of().run(*conn), ("STREAM"));
    TEST_EQ(R::range().limit(4).run(*conn), (R::Array{0, 1, 2, 3}));
    TEST_EQ(R::range(4).run(*conn), (R::Array{0, 1, 2, 3}));
    TEST_EQ(R::range(2, 5).run(*conn), (R::Array{2, 3, 4}));
    TEST_EQ(R::range(0).run(*conn), (R::Array{}));
    TEST_EQ(R::range(5, 2).run(*conn), (R::Array{}));
    TEST_EQ(R::range(-5, -2).run(*conn), (R::Array{-5, -4, -3}));
    TEST_EQ(R::range(-5, 2).run(*conn), (R::Array{-5, -4, -3, -2, -1, 0, 1}));
    TEST_EQ(R::range("foo").run(*conn), (err("RqlRuntimeError", "Expected type NUMBER but found STRING.", R::Array{})));
    TEST_EQ(R::range(9007199254740994.0).run(*conn), (err_regex("RqlRuntimeError", "Number not an integer \\(>2\\^53\\). 9007199254740994", R::Array{})));
    TEST_EQ(R::range(-9007199254740994.0).run(*conn), (err_regex("RqlRuntimeError", "Number not an integer \\(<-2\\^53\\). -9007199254740994", R::Array{})));
    TEST_EQ(R::range(0.5).run(*conn), (err_regex("RqlRuntimeError", "Number not an integer. 0\\.5", R::Array{})));
    TEST_EQ(R::range().count().run(*conn), (err("RqlRuntimeError", "Cannot use an infinite stream with an aggregation function (`reduce`, `count`, etc.) or coerce it to an array.", R::Array{})));
    TEST_EQ(R::range().coerce_to("ARRAY").run(*conn), (err("RqlRuntimeError", "Cannot use an infinite stream with an aggregation function (`reduce`, `count`, etc.) or coerce it to an array.", R::Array{})));
    TEST_EQ(R::range(4).count().run(*conn), (4));
    exit_section();
}
